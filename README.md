# obs_operator_calibration

## WCM calibration

### Description 

This repository contains Matlab files to calibrate the Water Cloud Model (WCM), using NASA Land Information System (LIS) output. These scripts are used to calibrate the WCM in De Lannoy et al., (2024, JAMES) and de Roos et al., (2024, Biogeosciences). 

- WCM: four parameters, A, B, C, D, and optionally the observation error standard deviation can be calibrated. The initial values for A and B vary with the chosen incidence angle.
- LIS output: containing surface soil moisture and LAI or biomass, as well as Sentinel-1 observations, collected during an open loop simulation. The output can be generated by any land surface or crop model, and has been tested for Noah-MP (De Lannoy et al., 2024) and AquaCrop (de Roos et al., 2024). 
- Optimization algorithm: four algorithms are tested, i.e. DREAMZS, PSO, SCE_gent, and SCEUA. Note that the latter two occasionally do not converge as well as the former.
- Objective function (OF): for now only the Bayesian objective function has been fully tested. This consists of 2 penalty terms: the sum of squared errors (SSE) between observed and simulated backscatter, and the SSE between an initial constraint on the parameters and their estimates.

### Contents

**1. Main script**
CalWCM_main.m can be run directly in the Matlab interface. Turn on the debug option (inside the code), to see some time series results.
CalWCM_main_PAR_CPU.m is the same script, but allows parallel processing. This script is called if the calibration is launched in the queue, e.g. as ./RUN/My_M_queued_WCM_irr.sh 

**2. Subroutines**
Optimization algorithms, functionalities to read model output, and WCM.

**3. RUN**
Directory with example files on how to submit a job in the queue for fast parallel calibration, and combining the output from multiple processors into a single output file.

### Citation

De Lannoy, G. J. M., Bechtold, M., Busschaert, L., Heyvaert, Z., Modanesi, S., Dunmire, D., et al. (2024). Contributions of irrigation modeling, soil moisture and snow data assimilation to high-resolution water budget estimates over the Po basin: Progress towards digital replicas. Journal of Advances in Modeling Earth Systems, 16, e2024MS004433. https://doi.org/10.1029/2024MS004433 
